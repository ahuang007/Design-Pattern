
# Decorator 模式

## 问题

* 在 OO 设计和开发过程，可能会经常遇到以下的情况：我们需要为一个已经定义好的类添加新的职责（操作），通常的情况我们会给定义一个新类继承自定义好的类，这样会带来一个问题。通过继承的方式解决这样的情况还带来了系统的复杂性，因为继承的深度会变得很深。

* Decorator 提供了一种给类增加职责的方法，不是通过继承实现的，而是通过组合。

## 代码说明

* Decorator 模式很简单，代码本身没有什么好说明的。运行示例代码可以看到，ConcreteDecorator给 ConcreteComponent 类添加了动作 AddedBehavior。

## 讨论 

* Decorator 模式和 Composite 模式有相似的结果图，其区别在 Composite 模式讨论。另外 GoF 在《设计模式》中也讨论到 Decorator 和 Proxy 模式有很大程序上的相似，初学设计模式可能实在看不出这之间的一个联系和相似，并且他们在结构图上也很不相似。实际上，让 Decorator 直接拥有一个 ConcreteComponent 的引用（指针）也可以达到修饰的功能，大家再把这种方式的结构图画出来，就和 Proxy 很相似了！

* Decorator 模式和 Proxy 模式的相似的地方在于它们都拥有一个指向其他对象的引用（指针），即通过组合的方式来为对象提供更多操作（或者 Decorator 模式）间接性（Proxy 模式）。但是它们的区别是，Proxy 模式会提供使用其作为代理的对象一样接口，使用代理类将其操作都委托给 Proxy 直接进行。这里可以简单理解为组合和委托之间的微妙的区别了。

* Decorator 模式除了采用组合的方式取得了比采用继承方式更好的效果，Decorator 模式还给设计带来一种“即用即付”的方式来添加职责。在 OO 设计和分析经常有这样一种情况：为了多态，通过父类指针指向其具体子类，但是这就带来另外一个问题，当具体子类要添加新的职责，就必须向其父类添加一个这个职责的抽象接口，否则是通过父类指针是调用不到这个方法了。这样处于高层的父类就继承了太多的特征（方法），并且继承自这个父类的所有子类都不可避免继承了父类的这些接口，但是可能这并不是这个具体子类所需要的。而在 Decorator 模式提供了一种较好的解决方法，当需要添加一个操作的时候就可以通过 Decorator 模式来解决，你可以一步步添加新的职责。






